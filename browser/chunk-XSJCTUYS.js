import{a as m}from"./chunk-U4HGQDOS.js";import{Ib as y,M as c,O as u,Q as l,Rc as a,n as p,p as h,x as f}from"./chunk-7YISJ2RF.js";var E=new u("Google Sheets API key"),g=(()=>{class i{constructor(t,e){this.http=t,this.apiKey=e,this.defaultActiveValues=["true","1","yes"]}get(t,e,o){return this.getRows(t,e).pipe(h(s=>this.rowsToEntries(s).map(r=>this.getObjectFromEntry(r,o))))}getActive(t,e,o,s="is_active",r=null){return r===null?r=this.defaultActiveValues:Array.isArray(r)||(r=[r]),this.getRows(t,e).pipe(h(n=>this.rowsToEntries(n).filter(d=>r.includes(d[s].toLowerCase())).map(d=>this.getObjectFromEntry(d,o))))}getSpreadsheetUrl(t,e){return"https://sheets.googleapis.com/v4/spreadsheets/"+t+"/values/"+encodeURI(e)+"?key="+this.apiKey}getRows(t,e){let o=this.getSpreadsheetUrl(t,e);return this.http.get(o).pipe(h(s=>s.values),f(this.handleError))}rowsToEntries(t){let e=t[0].map(this.cleanColumnName);return t.slice(1).map(o=>e.reduce((s,r,n)=>(s[r]=o.length>n?o[n]:"",s),{}))}cleanColumnName(t){return t.trim()}arrayToObject(t){return t.reduce((e,o)=>(e[o]=o,e),{})}getObjectFromEntry(t,e){return Array.isArray(e)&&(e=this.arrayToObject(e)),this.getObjectFromEntryObject(t,e)}getObjectFromEntryObject(t,e,o=""){let s={};for(let r in Object(e))if(e.hasOwnProperty(r)&&!["_prefix","_listField"].includes(r))if(typeof e[r]=="string")s[r]=this.getValueFromEntry(t,o+e[r]);else if(typeof e[r]=="object"){let n="";e[r].hasOwnProperty("_prefix")&&(n=e[r]._prefix),e[r]._listField?s[r]=this.getListFromEntry(t,o+n):s[r]=this.getObjectFromEntryObject(t,e[r],o+n)}else console.log(`Unknown type for ${r}`);return s}getValueFromEntry(t,e){return e=this.cleanColumnName(e),t.hasOwnProperty(e)?t[e]:null}getListFromEntry(t,e){let o=[],s=1,r=this.getValueFromEntry(t,`${e}${s}`);for(;r;)o.push(r),s++,r=this.getValueFromEntry(t,`${e}${s}`);return o}handleError(t){return t.error instanceof ErrorEvent?console.error("An error occurred:",t.error.message):console.error(`Backend returned code ${t.status}, body was: ${t.error}`),p("Something bad happened; please try again later.")}}return i.\u0275prov=c({factory:function(){return new i(l(y),l(E))},token:i,providedIn:"root"}),i})();var b={grade:"Grade",description:"Description"};var L=new m("configuration.service"),x=(()=>{class i{get TableGrades(){return this.dataTable}constructor(t){this.googleSheetsDbService=t,this.dataRequest$=this.googleSheetsDbService.get(a.googleSheet.spreadsheetId,a.googleSheet.worksheetGrades,b)}load(){return new Promise(t=>{this.dataRequest$.subscribe(e=>{this.dataTable=e,t(!0)})})}static{this.\u0275fac=function(e){return new(e||i)(l(g))}}static{this.\u0275prov=c({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var j={skillcode:"Skillcode",description:"Description",level:"Level"};var K=new m("configuration.service"),N=(()=>{class i{get TableSkills(){return this.dataTable}constructor(t){this.googleSheetsDbService=t,this.dataRequest$=this.googleSheetsDbService.get(a.googleSheet.spreadsheetId,a.googleSheet.worksheetSkills,j)}load(){return new Promise(t=>{this.dataRequest$.subscribe(e=>{this.dataTable=e,t(!0)})})}static{this.\u0275fac=function(e){return new(e||i)(l(g))}}static{this.\u0275prov=c({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{E as a,g as b,x as c,N as d};
